# -*- coding: utf-8 -*-
"""Gender Prediction ML.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1L4uXtkU97UGdZh0o_hmER-r-DV-cqpF3
"""

import numpy as np
import pandas as pd
from google.colab import files
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.naive_bayes import MultinomialNB

# Upload CSV files in Google Colab
female = files.upload()
male = files.upload()

# Read CSV files into DataFrames
dfmale = pd.read_csv('Indian-Female-Names.csv')
dffemale = pd.read_csv('Indian-Male-Names.csv')

# Map gender labels to numerical values
gender = {'m': 1, 'f': 0}
# dfmale.gender = [gender[item] for item in dfmale.gender]
dfmale.gender = dfmale.gender.map(gender)
# dffemale.gender = [gender[item] for item in dffemale.gender]
dffemale.gender = dffemale.gender.map(gender)

# Drop 'race' column
dfmale = dfmale.drop(columns=['race'])
dffemale = dffemale.drop(columns=['race'])

# Concatenate DataFrames
df = pd.concat([dfmale, dffemale])

# Shuffling the data
dffinal = df.sample(frac=1).reset_index(drop=True)

# Checking if any data is lost
# print(dffinal.size)

# Preprocess names using CountVectorizer ---> Text data to Numbers
cv = CountVectorizer()
names = dffinal['name']
X = cv.fit_transform(names.values.astype('U'))

# cv.get_feature_names_out()

# Split data into training and testing sets
Y = df.gender
x_train, x_test, y_train, y_test = train_test_split(X, Y, test_size=0.33, random_state=42)

# Train a Multinomial Naive Bayes classifier
model = MultinomialNB()
model.fit(x_train, y_train)

# Evaluate model on the testing set
accuracy = model.score(x_test, y_test)
print("Model Accuracy:", accuracy)

# Predict on new samples
sample = [input()]
vector = cv.transform(sample).toarray()
prediction = model.predict(vector)
print("Predicted Gender:", "Male" if prediction==1 else "Female")
